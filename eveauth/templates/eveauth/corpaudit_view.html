{% extends 'eveauth/base.html' %}
{% load static authtags humanize mathfilters %}

{% block title %}{{ corp.name }}{% endblock %}


{% block content %}
<div class="row">
  <div class="col-md-3 col-sm-4">
    <div class="panel panel-default">
      <div class="panel-heading">
          <strong>{{ corp.name }}</strong>
      </div>

      <div style="
        min-height: 260px;
        background-size: cover;
        background-image: url('https://imageserver.eveonline.com/Corporation/{{ corp.id }}_256.png');
        padding: 5px;
      ">
        {% if corp.alliance %}
        <div><img src="https://imageserver.eveonline.com/Alliance/{{ corp.alliance.id }}_64.png"></div>
        {% endif %}
      </div>

      <ul class="list-group">
        {% if corp.alliance %}
        <li class="list-group-item">
          {{ corp.alliance.name }}
        </li>
        {% endif %}

        <li class="list-group-item">
          {% with member_count=chars|length %}
          {{ char_count }}/{{ member_count }} characters ({{ 100|div:member_count|mul:char_count|floatformat:1 }} %)
          {% endwith %}
        </li>

        <li class="list-group-item">
          CEO: {{ corp.ceo.name }}
        </li>

        <li class="list-group-item">
          Founder: {{ corp.founder.name }}
        </li>

        <li class="list-group-item">
          Tax Rate: {{ corp.tax_rate|mul:100|floatformat:2 }}%
        </li>
      </ul>
    </div>
  </div>


  <div class="col-md-9 col-sm-8">
    <table class="table table-striped table-condensed">
      <tr>
        <th>Character</th>
        <th>Owner</th>
        <th>Location</th>
        <th>Ship</th>
      </tr>

      {% for char in chars %}
      <tr>
        <td>
          <img width="24" height="24" style="border-radius: 50%; margin-top: -12px; margin-bottom: -11px;" src="//imageserver.eveonline.com/Character/{{ char.character_id }}_32.jpg">
          {% if char.char %}
          <a href="{% url 'characteradmin_view' char.character_id %}">{{ char.name }}</a>
          {% else %}
          {{ char.name }}
          {% endif %}
        </td>
        <td>
          {% if char.char %}
          <img width="24" height="24" style="border-radius: 50%; margin-top: -12px; margin-bottom: -11px;" src="//imageserver.eveonline.com/Character/{{ char.char.owner.profile.character_id }}_32.jpg">
          <a href="{% url 'view_user' char.char.owner_id %}">{{ char.char.owner.profile.character.name }}</a>
          {% endif %}
        </td>
        <td>
          {% if char.char %}
          <img width="24" height="24" style="border-radius: 50%; margin-top: -12px; margin-bottom: -11px;" src="//imageserver.eveonline.com/Type/{{ char.char.system.sun_id }}_32.png">
          {{ char.char.system.name }}
          {% endif %}
        </td>
        <td>
          {% if char.char %}
          <img width="24" height="24" style="border-radius: 50%; margin-top: -12px; margin-bottom: -11px;" src="//imageserver.eveonline.com/Type/{{ char.char.ship_id }}_32.png">
          {{ char.char.ship.name }}
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </table>
  </div>
</div>
{% endblock %}
